/***************************************************************************/ /**
  @file     open_state.c
  @brief    open state functions
  @author   Grupo 2 - Lab de Micros
 ******************************************************************************/

/*******************************************************************************
 * INCLUDE HEADER FILES
 ******************************************************************************/
#include <stdbool.h>
#include "MplxLed.h"
#include "queue.h"
#include "Timer.h"
#include "open_state.h"

/*******************************************************************************
 * CONSTANT AND MACRO DEFINITIONS USING #DEFINE
 ******************************************************************************/
#define OPEN_TIME  5000 //5 segs

/*******************************************************************************
 * GLOBAL VARIABLES WITH FILE LEVEL SCOPE
 ******************************************************************************/

/*******************************************************************************
 * FUNCTION PROTOTYPES FOR PRIVATE FUNCTIONS WITH FILE LEVEL SCOPE
 **********************************************************************/

/*******************************************************************************
 *******************************************************************************
                        GLOBAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/
void openDoor(void)
{
    MplxLed_On(LED_TWO);    //"Opens" the door
    Timer_AddCallback(&accessTimeOut, OPEN_TIME, true);
}

void accessTimeOut(void)
{
    MplxLed_Off(LED_TWO);   //"Closes the door."
    emitEvent(TIMEOUT_EV);
}

/*******************************************************************************
 *******************************************************************************
                        LOCAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/

/*******************************************************************************
 ******************************************************************************/
